{"rewrite_config":{"enable":true,"rules":[{"enable":true,"id":"1","judge":{"type":0,"conditions":[{"type":"URI","operator":"match","value":"^\/rewrite_pass_access_forbidden\/(.*)$"}]},"name":"test_rewrite_one","handle":{"regrex":"^\/rewrite_pass_access_forbidden\/(.*)$","log":true,"rewrite_to":"\/rewrite_to\/$1"}},{"enable":true,"id":"2","judge":{"type":0,"conditions":[{"type":"URI","operator":"match","value":"^\/rewrite\/(.*)$"}]},"name":"test_rewrite_two","handle":{"regrex":"^\/rewrite\/(.*)$","log":true,"rewrite_to":"\/rewrite_pass\/$1\/tt\/$2"}}]},"redirect_config":{"enable":true,"rules":[{"enable":true,"id":"1","judge":{"type":0,"conditions":[{"type":"URI","operator":"match","value":"^\/redirect_pass_access_forbidden\/(.*)$"}]},"name":"test_redirect_one","handle":{"regrex":"^\/redirect_pass_access_forbidden\/(.*)$","log":true,"redirect_to":"\/redirect_to\/$1"}},{"enable":true,"id":"2","judge":{"type":1,"conditions":[{"type":"URI","operator":"match","value":"^\/baidu\/(.*)$"}]},"name":"test_redirect_two2","handle":{"regrex":"^\/baidu\/(.*)$","log":true,"redirect_to":"http:\/\/baidu.com\/s?wd=$1"}}]},"waf_config":{"enable":true,"rules":[{"enable":true,"id":"1","time":"2016-03-24 17:11:47","judge":{"type":0,"conditions":[{"type":"URI","operator":"match","value":"^\/rewrite_to"}]},"name":"test_rewrited","handle":{"log":false,"code":400,"perform":"deny"}},{"enable":true,"id":"2","judge":{"type":0,"conditions":[{"type":"URI","operator":"match","value":"\\.(ssh|sql)$"}]},"name":"test_only_one","handle":{"log":true,"code":401,"perform":"deny"}},{"enable":true,"id":"3","judge":{"type":1,"conditions":[{"type":"URI","operator":"match","value":"\\.(bash_history|exe)$"},{"type":"Header","operator":"=","name":"uid","value":"123"},{"type":"Host","operator":"=","value":"127.0.0.1"}]},"name":"test_all_and","handle":{"log":true,"code":402,"perform":"deny"}},{"enable":true,"id":"4","judge":{"type":2,"conditions":[{"type":"Header","operator":"=","name":"uid","value":"123"},{"type":"Header","operator":"=","name":"app","value":"abc"}]},"handle":{"log":true,"code":403,"perform":"deny"},"name":"test_all_or","time":"2016-03-24 17:15:48"},{"enable":true,"id":"5","judge":{"type":3,"conditions":[{"type":"URI","operator":"match","value":"^\/abc$"},{"type":"Header","operator":"=","name":"uid","value":"1234"},{"type":"Header","operator":"=","name":"app","value":"abcd"}],"expression":"(v[1] or v[2]) and v[3]"},"name":"test_complicated_case","handle":{"log":true,"code":405,"perform":"deny"}},{"enable":true,"id":"FE5AD23D-B40A-4C69-BCA5-965709D8E5CD","time":"2016-03-24 17:12:59","judge":{"type":0,"conditions":[{"type":"URI","operator":"match","value":"^\/redirect_to\/(.*)"}]},"name":"forbidden_redirect_to","handle":{"log":true,"code":403,"perform":"deny"}}]},"divide_config":{"enable":true,"rules":[{"upstream_url":"https:\/\/baidu.com","time":"2016-03-29 16:50:21","enable":true,"id":"08F9FD2A-A46C-4328-BF5B-CAC4969E60B8","log":true,"judge":{"type":0,"conditions":[{"type":"Header","operator":"=","name":"search","value":"true"}]},"name":"by_header","upstream_host":"baidu.com"},{"upstream_url":"http:\/\/up1","upstream_host":"up1.test.com","judge":{"type":0,"conditions":[{"type":"Host","operator":"=","value":"up1.test.com"}]},"id":"A79500B4-FE76-4787-B86B-C543F0B8C2D4","log":true,"time":"2016-03-29 15:45:26","name":"by_host","enable":true},{"upstream_url":"http:\/\/up2","upstream_host":"up2.test.com","judge":{"type":0,"conditions":[{"type":"URI","operator":"match","value":"\/to_up2"}]},"id":"A42637F1-6B1C-40F8-AC71-D807BBBB566C","log":true,"time":"2016-03-29 15:12:37","name":"by_uri","enable":true}]}}