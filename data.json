{"rewrite_config":{"enable":true,"rewrite_rules":[{"enable":true,"id":"1","matcher":{"type":0,"conditions":[{"type":"URI","operator":"≈","value":"^\/rewrite_pass_access_forbidden\/(.*)$"}]},"name":"test_rewrite_one","action":{"regrex":"^\/rewrite_pass_access_forbidden\/(.*)$","rewrite_to":"\/rewrite_to\/$1","log":true}},{"enable":true,"id":"2","matcher":{"type":0,"conditions":[{"type":"URI","operator":"≈","value":"^\/rewrite\/(.*)$"}]},"name":"test_rewrite_two","action":{"regrex":"^\/rewrite\/(.*)$","rewrite_to":"\/rewrite_pass\/$1\/tt\/$2","log":true}},{"enable":true,"id":"3","matcher":{"type":0,"conditions":[{"type":"URI","operator":"=","value":"\/"}]},"name":"test_rewrite_3","action":{"regrex":"^\/(.*)$","rewrite_to":"\/rewrite_pass\/root","log":true}}]},"redirect_config":{"enable":true,"redirect_rules":[{"enable":true,"id":"1","matcher":{"type":0,"conditions":[{"type":"URI","operator":"≈","value":"^\/redirect_pass_access_forbidden\/(.*)$"}]},"name":"test_redirect_one","action":{"regrex":"^\/redirect_pass_access_forbidden\/(.*)$","log":true,"redirect_to":"\/redirect_to\/$1"}},{"enable":true,"id":"2","matcher":{"type":0,"conditions":[{"type":"URI","operator":"≈","value":"^\/baidu\/(.*)$"}]},"name":"test_redirect_two","action":{"regrex":"^\/baidu\/(.*)$","log":true,"redirect_to":"http:\/\/baidu.com\/s?wd=$1"}}]},"waf_config":{"enable":false,"access_rules":[{"enable":true,"id":"1","matcher":{"type":0,"conditions":[{"type":"URI","operator":"≈","value":"^\/rewrite_to"}]},"name":"test_rewrited","action":{"log":false,"code":400,"perform":"deny"}},{"enable":true,"id":"2","matcher":{"type":0,"conditions":[{"type":"URI","operator":"≈","value":"\\.(ssh|sql)$"}]},"name":"test_only_one","action":{"log":true,"code":401,"perform":"deny"}},{"enable":true,"id":"3","matcher":{"type":1,"conditions":[{"type":"URI","operator":"≈","value":"\\.(bash_history|exe)$"},{"type":"Header","operator":"=","name":"uid","value":"123"},{"type":"Host","operator":"=","value":"127.0.0.1"}]},"name":"test_all_and","action":{"log":true,"code":402,"perform":"deny"}},{"enable":false,"id":"4","matcher":{"type":2,"conditions":[{"type":"Header","operator":"=","name":"uid","value":"123"},{"type":"Header","operator":"=","name":"app","value":"abc"}]},"name":"test_all_or","action":{"log":true,"code":403,"perform":"deny"}},{"enable":true,"id":"5","matcher":{"type":3,"conditions":[{"type":"URI","operator":"≈","value":"^\/abc$"},{"type":"Header","operator":"=","name":"uid","value":"1234"},{"type":"Header","operator":"=","name":"app","value":"abcd"}],"expression":"(v[1] or v[2]) and v[3]"},"name":"test_complicated_case","action":{"log":true,"code":405,"perform":"deny"}},{"enable":true,"id":"903A8410-3A56-4376-9C43-5AA6CB9C3BA4","matcher":{"type":3,"conditions":[{"type":"Header","operator":"≈","name":"name","value":"app"},{"type":"IP","operator":"=","value":"127.0.0.1"},{"type":"UserAgent","operator":"!=","value":"ua\/abdf"},{"type":"Host","operator":"!=","value":"127.0.0.1"},{"type":"Referer","operator":"=","value":"baidu.com"}],"expression":"v[1] and v[2] or v[5]"},"name":"test-ip-and-name","action":{"log":true,"code":409,"perform":"deny"}},{"enable":false,"id":"06D00387-66E6-4621-B847-12BDA175A0B9","matcher":{"type":0,"conditions":[{"type":"URI","operator":"≈","value":"fdsfdsf"}]},"name":"fdsfdsfs","action":{"log":false,"perform":"allow"}}]}}